<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blade Harmonics Visualizer</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .controls {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        label {
            font-weight: 600;
            color: #333;
            min-width: 150px;
            font-size: 1.1em;
        }

        input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            transition: background 0.2s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            background: #764ba2;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .value-display {
            font-weight: bold;
            color: #667eea;
            min-width: 60px;
            text-align: right;
            font-size: 1.2em;
        }

        .plot-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .plot-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .info-box {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .info-box p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .math {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .control-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            label {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŒ€ Blade Harmonics Visualizer</h1>
        
        <div class="controls">
            <div class="control-group">
                <label for="numBlades">Number of Blades (B):</label>
                <input type="range" id="numBlades" min="1" max="8" value="3" step="1">
                <span class="value-display" id="numBladesValue">3</span>
            </div>
            
            <div class="control-group">
                <label for="phaseShift">Phase Shift (Î”Ïˆ):</label>
                <input type="range" id="phaseShift" min="0" max="6.28" value="0" step="0.01">
                <span class="value-display" id="phaseShiftValue">0.00</span>
            </div>
            
            <div class="control-group">
                <label for="resolution">Resolution:</label>
                <input type="range" id="resolution" min="100" max="1000" value="360" step="10">
                <span class="value-display" id="resolutionValue">360</span>
            </div>
        </div>

        <div class="plot-container">
            <div class="plot-title">sin(Î¸ + Î”Ïˆ + 2Ï€b/B) - Individual Blades and Sum</div>
            <div id="sinPlot"></div>
        </div>

        <div class="plot-container">
            <div class="plot-title">sinÂ²(Î¸ + Î”Ïˆ + 2Ï€b/B) - Individual Blades and Sum</div>
            <div id="sin2Plot"></div>
        </div>

        <div class="info-box">
            <h3>Theory</h3>
            <p><strong>For sin(Î¸):</strong> The sum of equally-spaced sinusoids is zero for B â‰¥ 2. This is due to rotational symmetry and the roots of unity theorem.</p>
            <div class="math">âˆ‘[b=0 to B-1] sin(Î¸ + 2Ï€b/B) = 0</div>
            
            <p><strong>For sinÂ²(Î¸):</strong> Using the identity sinÂ²(x) = (1 - cos(2x))/2, the sum becomes:</p>
            <div class="math">âˆ‘[b=0 to B-1] sinÂ²(Î¸ + 2Ï€b/B) = B/2</div>
            
            <p>This explains why you see different behavior: sin harmonics cancel completely, but sinÂ² harmonics average to a constant B/2.</p>
        </div>
    </div>

    <script>
        // Get DOM elements
        const numBladesSlider = document.getElementById('numBlades');
        const phaseShiftSlider = document.getElementById('phaseShift');
        const resolutionSlider = document.getElementById('resolution');
        const numBladesValue = document.getElementById('numBladesValue');
        const phaseShiftValue = document.getElementById('phaseShiftValue');
        const resolutionValue = document.getElementById('resolutionValue');

        // Update displays
        function updateDisplays() {
            numBladesValue.textContent = numBladesSlider.value;
            phaseShiftValue.textContent = parseFloat(phaseShiftSlider.value).toFixed(2);
            resolutionValue.textContent = resolutionSlider.value;
        }

        // Generate data for plots
        function generateData() {
            const B = parseInt(numBladesSlider.value);
            const dpsi = parseFloat(phaseShiftSlider.value);
            const resolution = parseInt(resolutionSlider.value);
            
            // Generate theta values
            const theta = Array.from({length: resolution}, (_, i) => (2 * Math.PI * i) / resolution);
            
            // Initialize sum arrays
            const sinSum = new Array(resolution).fill(0);
            const sin2Sum = new Array(resolution).fill(0);
            
            const sinTraces = [];
            const sin2Traces = [];
            
            // Generate data for each blade
            for (let b = 0; b < B; b++) {
                const phase = dpsi + (2 * Math.PI * b) / B;
                const sinValues = theta.map(t => Math.sin(t + phase));
                const sin2Values = theta.map(t => Math.pow(Math.sin(t + phase), 2));
                
                // Add to sums
                for (let i = 0; i < resolution; i++) {
                    sinSum[i] += sinValues[i];
                    sin2Sum[i] += sin2Values[i];
                }
                
                // Create traces for individual blades
                sinTraces.push({
                    x: theta,
                    y: sinValues,
                    mode: 'lines',
                    name: `Blade ${b + 1}`,
                    line: {width: 1.5},
                    opacity: 0.6
                });
                
                sin2Traces.push({
                    x: theta,
                    y: sin2Values,
                    mode: 'lines',
                    name: `Blade ${b + 1}`,
                    line: {width: 1.5},
                    opacity: 0.6
                });
            }
            
            // Add sum traces
            sinTraces.push({
                x: theta,
                y: sinSum,
                mode: 'lines',
                name: 'Sum',
                line: {width: 3, color: 'black'},
                opacity: 1
            });
            
            sin2Traces.push({
                x: theta,
                y: sin2Sum,
                mode: 'lines',
                name: 'Sum',
                line: {width: 3, color: 'black'},
                opacity: 1
            });
            
            return {sinTraces, sin2Traces};
        }

        // Plot configuration
        const layout = {
            xaxis: {
                title: 'Î¸ (radians)',
                gridcolor: '#e0e0e0',
                tickmode: 'array',
                tickvals: [0, Math.PI/2, Math.PI, 3*Math.PI/2, 2*Math.PI],
                ticktext: ['0', 'Ï€/2', 'Ï€', '3Ï€/2', '2Ï€']
            },
            yaxis: {
                title: 'Value',
                gridcolor: '#e0e0e0'
            },
            plot_bgcolor: '#fafafa',
            paper_bgcolor: 'white',
            margin: {l: 60, r: 40, t: 40, b: 60},
            hovermode: 'closest',
            showlegend: true,
            legend: {
                x: 1.02,
                y: 1,
                xanchor: 'left',
                yanchor: 'top'
            }
        };

        const config = {
            responsive: true,
            displayModeBar: true,
            displaylogo: false,
            modeBarButtonsToRemove: ['lasso2d', 'select2d']
        };

        // Update plots
        function updatePlots() {
            updateDisplays();
            const {sinTraces, sin2Traces} = generateData();
            
            const sinLayout = {...layout, yaxis: {...layout.yaxis, title: 'sin(Î¸ + Î”Ïˆ + 2Ï€b/B)'}};
            const sin2Layout = {...layout, yaxis: {...layout.yaxis, title: 'sinÂ²(Î¸ + Î”Ïˆ + 2Ï€b/B)'}};
            
            Plotly.newPlot('sinPlot', sinTraces, sinLayout, config);
            Plotly.newPlot('sin2Plot', sin2Traces, sin2Layout, config);
        }

        // Event listeners
        numBladesSlider.addEventListener('input', updatePlots);
        phaseShiftSlider.addEventListener('input', updatePlots);
        resolutionSlider.addEventListener('input', updatePlots);

        // Initial plot
        updatePlots();
    </script>
</body>
</html>


